const { createProduct,
    getProducts,
    getProductById,
    updateProductById,
    deleteById,
  getProductByQuery,
  updateStockByPid } = require('../controllers/productController');

const router = require('express').Router();

// CORS middleware
router.use((req, res, next) => {
  // Allow requests from localhost:3000 and https://alabites-ordering-app.vercel.app
  res.setHeader('Access-Control-Allow-Origin', 'http://localhost:3000');
  res.setHeader('Access-Control-Allow-Methods', 'GET, POST, OPTIONS, PUT, DELETE, PATCH');
  res.setHeader('Access-Control-Allow-Headers', 'Content-Type');
  next();
});


// Define your product routes below
router.post('/', createProduct); // Route for creating a new product (secure)
router.get('/', getProducts); // Route for fetching all products
router.get('/query/:query', getProductByQuery); // Route for querying products by PID, productName, price, store, or category
router.get('/:id', getProductById); // Route for fetching a product by ID
router.put('/:id', updateProductById); // Route for updating a product by ID (secure)
router.delete('/:id', deleteById); // Route for deleting a product by ID (secure)

router.put('/stock/:pid', updateStockByPid);

module.exports = router;
