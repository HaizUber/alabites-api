const router = require('express').Router();

// CORS middleware
router.use((req, res, next) => {
  // Extract the origin from the request headers
  const origin = req.headers.origin;

  // Log the origin for debugging
  console.log('Origin:', origin);

  // Check if the origin is allowed
  if (origin && (origin === 'http://localhost:3000' || origin === 'https://alabites-ordering-app.vercel.app')) {
    // Log the allowed origin
    console.log('Allowed origin:', origin);
    
    // Set the Access-Control-Allow-Origin header with the allowed origin
    res.setHeader('Access-Control-Allow-Origin', origin);
  } else {
    // Log the disallowed origin
    console.log('Disallowed origin:', origin);
  }

  // Set other CORS headers
  res.setHeader('Access-Control-Allow-Methods', 'GET, POST, OPTIONS, PUT, DELETE');
  res.setHeader('Access-Control-Allow-Headers', 'Content-Type');
  next();
});

module.exports = router;
